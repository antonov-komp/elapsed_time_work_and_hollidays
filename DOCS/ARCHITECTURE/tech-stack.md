# Технологический стек приложения

**Дата создания:** 2025-12-12 10:46 (UTC+3, Брест)  
**Версия:** 1.0  
**Описание:** Описание технологического стека приложения-встройки Bitrix24 "Мой Ежемесячный табель присутствия"

---

## Общая информация

**Тип приложения:** Встройка в интерфейс Bitrix24 (Local Application)  
**Placement:** `USER_PROFILE_TOOLBAR` (встраивается в профиль пользователя)  
**Мобильное приложение:** Доступен пункт меню в мобильном приложении Bitrix24  
**Статус:** Нулевая сборка (базовая структура готова)

---

## Backend

### PHP
- **Версия:** PHP 8.3+ (рекомендуется PHP 8.4)
- **Использование:** Чистый PHP без фреймворков
- **Назначение:** Обработка запросов, работа с Bitrix24 REST API

### Bitrix24 REST API
- **Тип интеграции:** REST API через OAuth 2.0
- **Библиотека:** CRest (встроенная библиотека для работы с Bitrix24 REST API)
- **Версия CRest:** 1.36
- **Документация:**
  - https://context7.com/bitrix24/rest/
  - https://apidocs.bitrix24.ru/

### Аутентификация
- **Метод:** OAuth 2.0 (Application ID + Application Secret)
- **Хранение токенов:** `settings.json` (в .gitignore)
- **Обновление токенов:** Автоматическое через refresh_token

---

## Frontend

### Текущее состояние
- **HTML/CSS:** Базовая верстка с Bootstrap
- **JavaScript:** jQuery 3.6.0 (временное решение)
- **Стили:** `css/app.css` (Bootstrap)

### Планируемая разработка
- **Vue.js:** Версия 3.x (Composition API)
- **Подход:** Компонентный подход к разработке UI
- **Интеграция:** Интеграция с Bitrix24 BX.* API
- **Сборка:** Webpack или Vite для production

---

## Структура проекта

```
back1/
├── install.php              # Установка приложения и регистрация placement
├── placement.php            # Точка входа для placement USER_PROFILE_TOOLBAR
├── index.php                # Главная страница приложения
├── crest.php                # Библиотека CRest для работы с Bitrix24 REST API
├── settings.php             # Настройки приложения (секреты)
├── settings.json            # Сохранённые токены (в .gitignore)
├── checkserver.php          # Проверка сервера
├── css/
│   └── app.css             # Стили приложения
├── logs/                    # Логи приложения
├── DOCS/                    # Документация проекта
│   ├── ARCHITECTURE/       # Архитектурная документация
│   ├── TASKS/              # Задачи для разработки
│   ├── GUIDES/             # Руководства
│   ├── API-REFERENCES/     # Справочники API
│   └── PLAN/               # Планы развития
└── .gitignore              # Игнорируемые файлы
```

---

## Placements Bitrix24

### USER_PROFILE_TOOLBAR
- **Описание:** Встраивается в профиль пользователя Bitrix24
- **Обработчик:** `placement.php`
- **Регистрация:** Автоматически при установке через `install.php`
- **Документация:** https://context7.com/bitrix24/rest/placement/

---

## Мобильное приложение

- **Доступ:** Пункт меню в мобильном приложении Bitrix24
- **Реализация:** Через настройки приложения в Bitrix24

---

## API методы Bitrix24 (используемые)

### Текущие методы
- `user.current` — получение данных текущего пользователя
- `placement.bind` — регистрация placement
- `placement.unbind` — удаление placement

### Планируемые методы
- Методы для работы с табелем присутствия (будут определены в задачах)

---

## Ограничения и требования

### Серверные требования
- PHP 8.3+ с расширением curl
- Права на запись в папку `logs/` (775)
- Права на запись файла `settings.json` (664)
- HTTPS (рекомендуется для production)

### Bitrix24 требования
- Облачная версия Bitrix24 или коробочная версия
- Права на установку локальных приложений
- OAuth Application ID и Secret

---

## Безопасность

### Секреты
- `C_REST_CLIENT_ID` — Application ID (в `settings.php`, в .gitignore)
- `C_REST_CLIENT_SECRET` — Application Secret (в `settings.php`, в .gitignore)
- `settings.json` — токены доступа (в .gitignore)

### Рекомендации
- Не коммитить `settings.php` и `settings.json` в репозиторий
- Использовать HTTPS для всех запросов
- Валидация всех входящих данных
- Логирование всех операций

---

## Логирование

- **Папка:** `logs/YYYY-MM-DD/HH/`
- **Формат:** JSON или var_export (зависит от настройки)
- **Типы логов:**
  - `installation` — установка приложения
  - `callCurl` — вызовы REST API
  - `exceptionCurl` — исключения при вызовах API

---

## Документация

- **Основная документация:** `DOCS/`
- **Архитектура:** `DOCS/ARCHITECTURE/`
- **Задачи:** `DOCS/TASKS/`
- **Руководства:** `DOCS/GUIDES/`
- **Справочники API:** `DOCS/API-REFERENCES/`
- **Планы:** `DOCS/PLAN/`

---

## История изменений

- **2025-12-12 10:46 (UTC+3, Брест):** Создан документ, описана нулевая сборка приложения


