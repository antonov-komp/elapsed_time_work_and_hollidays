# TASK-004-01: Компонент прелоадера

**Дата создания:** 2025-12-12 11:53 (UTC+3, Брест)  
**Статус:** Новая  
**Приоритет:** Высокий  
**Исполнитель:** Bitrix24 Программист (Vue.js)  
**Родительская задача:** [TASK-004](TASK-004-basic-vue-components.md)  
**Подэтап:** 4.1 из 6  
**Длительность:** 0.5 дня

---

## Описание

Создание компонента `Preloader.vue` для отображения индикатора загрузки с overlay, блокирующим интерфейс во время загрузки данных.

**Связь с ТЗ:** [DOCS/TZ/interface-timesheet-calendar.md](../TZ/interface-timesheet-calendar.md) - раздел 1.2  
**Связь с этапами:** [DOCS/TZ/implementation-stages.md](../TZ/implementation-stages.md) - Этап 4, Подэтап 4.1

---

## Контекст

Это первый подэтап создания базовых компонентов Vue.js. Компонент прелоадера необходим для индикации процесса загрузки данных при первом запуске приложения и при обновлении данных.

**Зависит от:**
- TASK-001-05: Настройка базовой структуры компонентов (файл уже создан)

---

## Модули и компоненты

### Frontend (Vue.js)
- `js/vue-apps/timesheet/components/Preloader.vue` — компонент прелоадера

---

## Зависимости

- **От каких задач зависит:**
  - TASK-001-05: Настройка базовой структуры компонентов
- **Какие задачи зависят от этой:**
  - TASK-004-06: Компонент календарной сетки — будет использовать прелоадер
  - TASK-005: Функциональные компоненты и логика — будет использовать прелоадер

---

## Ступенчатые подзадачи

### Шаг 1: Открытие файла
1. Открыть файл `js/vue-apps/timesheet/components/Preloader.vue`
2. Проверить, что файл существует (создан в TASK-001-05)

### Шаг 2: Создание структуры компонента
1. Создать секцию `<template>` с базовой разметкой
2. Создать секцию `<script setup>` для логики
3. Создать секцию `<style scoped>` для стилей

### Шаг 3: Реализация overlay
1. Создать div с классом `preloader-overlay`
2. Установить `position: fixed` для покрытия всего экрана
3. Установить `z-index: 9999` для отображения поверх всего
4. Добавить полупрозрачный фон (rgba)
5. Использовать `v-if` для условного отображения

### Шаг 4: Реализация индикатора загрузки
1. Создать div с классом `preloader-spinner`
2. Реализовать анимацию вращения (CSS animation)
3. Добавить стили для spinner (круг с границей)

### Шаг 5: Добавление пропсов
1. Добавить проп `visible` типа Boolean
2. Установить значение по умолчанию `false`
3. Использовать проп для управления видимостью

### Шаг 6: Добавление стилей
1. Добавить стили для overlay
2. Добавить стили для spinner
3. Добавить анимацию вращения (@keyframes)
4. Убедиться, что стили scoped

---

## Технические требования

### Vue.js
- **Версия:** Vue.js 3.x (Composition API)
- **Подход:** `<script setup>` синтаксис
- **Стили:** Scoped styles

### Визуальные требования
- Overlay должен покрывать весь экран
- Spinner должен быть центрирован
- Анимация должна быть плавной
- Цвета должны соответствовать гайдлайнам Bitrix24

---

## Критерии приёмки

- [ ] Создан компонент `Preloader.vue`
- [ ] Компонент отображает индикатор загрузки (spinner)
- [ ] Реализован overlay с блокировкой интерфейса
- [ ] Компонент управляется через проп `visible`
- [ ] Overlay покрывает весь экран
- [ ] Spinner центрирован
- [ ] Анимация вращения работает плавно
- [ ] Стили применены корректно (scoped)
- [ ] Компонент можно использовать в других компонентах

---

## Примеры кода

### Preloader.vue
```vue
<template>
  <div v-if="visible" class="preloader-overlay">
    <div class="preloader-spinner"></div>
  </div>
</template>

<script setup>
/**
 * Компонент прелоадера
 * 
 * Отображает индикатор загрузки с overlay, блокирующим интерфейс
 */
defineProps({
  /**
   * Видимость прелоадера
   */
  visible: {
    type: Boolean,
    default: false
  }
});
</script>

<style scoped>
.preloader-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.5);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9999;
}

.preloader-spinner {
  width: 50px;
  height: 50px;
  border: 4px solid #f3f3f3;
  border-top: 4px solid #3498db;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
</style>
```

### Использование в компоненте
```vue
<template>
  <div>
    <Preloader :visible="loading" />
    <!-- Остальной контент -->
  </div>
</template>

<script setup>
import { ref } from 'vue';
import Preloader from './components/Preloader.vue';

const loading = ref(false);

// Пример использования
async function loadData() {
  loading.value = true;
  try {
    // Загрузка данных
    await fetchData();
  } finally {
    loading.value = false;
  }
}
</script>
```

---

## Тестирование

### Тестирование компонента
1. Импортировать компонент в тестовый файл
2. Проверить отображение при `visible: true`
3. Проверить скрытие при `visible: false`
4. Проверить, что overlay блокирует клики
5. Проверить анимацию spinner

---

## История правок

- **2025-12-12 11:53 (UTC+3, Брест):** Создана задача TASK-004-01

---

## Примечания

### Важные замечания
- Компонент должен быть простым и переиспользуемым
- Overlay должен блокировать все взаимодействия с интерфейсом
- Анимация должна быть плавной и не нагружать производительность

### Следующие шаги
После завершения этого подэтапа можно переходить к:
- TASK-004-02: Компонент информации о пользователе
- TASK-004-06: Компонент календарной сетки — будет использовать прелоадер

---

## Связь с документацией

- **Родительская задача:** [TASK-004](TASK-004-basic-vue-components.md)
- **Техническое задание:** [DOCS/TZ/interface-timesheet-calendar.md](../TZ/interface-timesheet-calendar.md) - раздел 1.2

